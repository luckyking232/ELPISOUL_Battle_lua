本文档描述了游戏战斗系统的核心模块，包括战斗结算界面、技能系统、战斗逻辑控制和数据统计等功能。
模块结构
1. 战斗结算界面模块
1.1 BattleFinishWindow (文档1)
功能: 战斗胜利结算界面
显示战斗结果和奖励信息
处理经验值变化和等级提升
展示获得的物品和角色升级
提供数据统计和战斗回放功能
核心功能:
UpdateInfo(): 更新战斗结果信息
UpdateExp(): 处理经验值动画显示
UpdateItem(): 显示掉落物品
CloseWindow(): 关闭结算界面
1.2 BattleFinishFailWindow (文档10)
功能: 战斗失败结算界面
显示失败提示和推荐提升途径
提供重新挑战和退出选项
展示战斗数据统计
2. 战斗技能系统
2.1 BattleBurstSkill (文档2)
功能: 爆裂技能管理
创建和管理爆裂技能实例
处理技能配置和等级信息
控制技能触发条件
核心类:
local skill = {
    burstId = nil,      -- 爆裂ID
    skillId = nil,      -- 技能ID
    camp = nil,         -- 所属阵营
    enemyCamp = nil     -- 敌方阵营
}
2.2 BattleChoose (文档4)
功能: 战斗目标选择系统
实现复杂的技能目标选择逻辑
支持多种选择策略（最近、随机、血量最高等）
处理范围技能和特殊效果
主要功能:
GetTargetUnitList(): 获取技能目标列表
GetNearestUnit(): 选择最近单位
GetRandomUnitList(): 随机选择单位
支持100+种目标选择策略
3. 战斗核心逻辑
3.1 BattleCamp (文档3)
功能: 阵营管理
管理阵营buff和充能系统
处理阵营级别的状态效果
控制时间暂停机制
3.2 BattleControl (文档6)
功能: 战斗流程控制
管理战斗帧更新逻辑
处理战斗暂停和继续
控制战斗结束流程
核心流程:
开始战斗 → 帧更新 → 技能处理 → 状态判断 → 战斗结束
3.3 BattleData (文档7)
功能: 战斗数据管理
存储战斗配置和状态数据
管理随机数种子
处理战斗评分系统
3.4 BattleDataCount (文档8)
功能: 战斗数值计算
处理伤害和治疗计算
实现属性克制系统
管理暴击、格挡等战斗机制
计算公式:
伤害 = 基础攻击 × 技能系数 × (1 + 暴击加成) × 防御减免 × 属性克制
4. 数据统计界面
4.1 BattleDataWindow (文档9)
功能: 战斗数据统计界面
展示详细的战斗数据
支持多种排序方式
显示技能使用统计
数据类型:
伤害统计
承受伤害
治疗量
技能使用次数
5. 枚举和配置
5.1 战斗状态枚举 (文档5)
包含的枚举类型:
BATTLE_STATE_ENUM: 战斗单位状态
BATTLE_CAMP_FLAG: 阵营标识
BUFF_EFFECT_ID: Buff效果ID
SKILL_DIRECTION: 技能方向
核心机制
战斗流程
初始化: 加载战斗数据和角色信息
进行中: 实时计算伤害、处理技能
结算: 显示结果、发放奖励
统计: 提供详细数据回顾
技能系统
目标选择: 支持多种智能选择算法
效果计算: 复杂的属性相互作用
连锁反应: Buff和Debuff的叠加效果
数值平衡
基于属性克制系统
考虑距离、阵营等因素
支持复杂的战斗公式
技术特点
模块化设计: 各功能模块职责清晰
配置驱动: 大量使用数据表配置
扩展性强: 支持新技能类型和战斗机制
性能优化: 帧更新和对象池管理
使用示例
-- 初始化战斗
BattleData.InitData()
BattleControl.Start()

-- 处理技能释放
local targetList = BattleChoose.GetSkillTargetUnitList(fromUnit, toList, skillConfig)
local damage = BattleDataCount.GetSkillHurt(skillId, subSkillId, attacker, defender)
这个文档系统为游戏提供了完整的战斗解决方案，从底层数值计算到上层界面展示，涵盖了现代卡牌战斗游戏的所有核心功能。
